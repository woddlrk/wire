<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        @import url(https://qwerewqwerew.github.io/source/style/reset.css);
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <style>
        html,
        body {
            position: relative;
            height: 100%;
        }

        section.vh100 {
            width: 100%;
            height: 100vh;
            background: #ccc;
        }

        .swiper {
            width: 100%;
            height: 100%;
        }

        .swiper-slide {
            text-align: center;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>
    <div class="swiper verticals">
        <div class="swiper-wrapper">
            <section class="vh100 swiper-slide"> 1 </section>
            <section class="vh100 swiper-slide"> 2 </section>
            <section class="vh100 swiper-slide"> 3 </section>
            <section class="swiper horizontals swiper-slide">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">Slide 1</div>
                    <div class="swiper-slide">Slide 2</div>
                    <div class="swiper-slide">Slide 3</div>
                    <div class="swiper-slide">Slide 4</div>
                </div>
                <div class="swiper-pagination"></div>
            </section>
            <section class="vh100 swiper-slide"> 5 </section>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        let vSwiper;   // 세로(Vertical) 슬라이더
        let hSwiper;   // 가로(Horizontal) 슬라이더
        /**
         * 가로슬라이더
         * **/
        hSwiper = new Swiper('.horizontals', {
            direction: 'horizontal',
            slidesPerView: 1,
            spaceBetween: 30,
            mousewheel: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            on: {
                reachEnd: function () {
                    // 동적객체속성
                    hSwiper.canNext = true;
                    //console.log("가로마지막", hSwiper.canNext);
                },
                reachBeginning: function () {
                    hSwiper.canPrev = true;
                },
                transitionEnd: function () {
                    console.log("슬라이더 이동 끝", hSwiper.isEnd);
                    if (hSwiper.canNext && hSwiper.isEnd) {
                        console.log('세로이동');
                        vSwiper.allowTouchMove = true;
                        vSwiper.mousewheel.enable();
                        hSwiper.canNext = false;
                    }
                    if (hSwiper.canPrev && hSwiper.isBeginning) {
                        console.log('2번으로 이동');
                        vSwiper.allowTouchMove = true;
                        vSwiper.mousewheel.enable();
                        hSwiper.canPrev = false;
                    }
                }

            }
        });

        /**
         * 세로슬라이더
         * **/

        vSwiper = new Swiper('.verticals', {
            direction: 'vertical',
            slidesPerView: 1,
            mousewheel: true,
            on: {
                slideChange: function () {
                    //console.log("현재섹션:", this.activeIndex + 1);
                    if (this.activeIndex === 3) {
                        vSwiper.allowTouchMove = false;
                        vSwiper.mousewheel.disable();
                    }
                    else {
                        console.log("5->4");
                        vSwiper.allowTouchMove = true;
                        vSwiper.mousewheel.enable();
                    }
                },
                slideChangeTransitionStart: function () {
                    /*           console.log("세로이동시작:", this.previousIndex + 1, '->', this.activeIndex + 1);
                    */
                    if (this.previousIndex === 4 && this.activeIndex === 3) {
                        // console.log('5->4');
                        vSwiper.allowTouchMove = false;
                        vSwiper.mousewheel.disable();
                        // slideTo(슬라이드 인덱스번호, 애니메이션 시간)
                        hSwiper.slideTo(3,0);
                    }
                },
                slideChangeTransitionEnd: function () {
                    if (this.activeIndex ===3){
                        hSwiper.update();
                        // 슬라이더의 위치를 다시 계산, 레이아웃 변화후 정확한 동작을 보장
                    }
                 },
            }
        });
    </script>
</body>

</html>